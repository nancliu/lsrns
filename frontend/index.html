<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OD数据处理与仿真系统</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>OD数据处理与仿真系统</h1>
            <p>基于案例管理的交通仿真分析平台</p>
        </header>

        <nav class="navigation">
            <ul>
                <li><a href="#od-processing" class="nav-link active">OD数据处理</a></li>
                <li><a href="#simulation" class="nav-link">仿真运行</a></li>
                <li><a href="#accuracy-analysis" class="nav-link">结果分析</a></li>
                <li><a href="#case-management" class="nav-link">案例管理</a></li>
                <li><a href="#templates" class="nav-link">模板查看</a></li>
                
            </ul>
        </nav>

        <main class="main-content">
            <!-- 1. OD数据处理 -->
            <section id="od-processing" class="section active">
                <h2>OD数据处理</h2>
                <div class="processing-form">
                    <form id="od-processing-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="start-time">开始时间:</label>
                                <input type="datetime-local" id="start-time" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="end-time">结束时间:</label>
                                <input type="datetime-local" id="end-time" class="form-control" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="taz-file">TAZ文件:</label>
                                <select id="taz-file" class="form-control" required>
                                    <option value="">请选择TAZ文件</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="network-file">网络文件:</label>
                                <select id="network-file" class="form-control" required>
                                    <option value="">请选择网络文件</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="interval-minutes">时间间隔(分钟):</label>
                                <input type="number" id="interval-minutes" class="form-control" value="5" min="1" max="60">
                            </div>
                            <div class="form-group">
                                <label for="case-name">案例名称:</label>
                                <input type="text" id="case-name" class="form-control" placeholder="自动生成，可自定义">
                            </div>
                        </div>
                        
                        <!-- 仿真输出配置 -->
                        <div class="form-row">
                            <div class="form-group" style="flex:1;">
                                <label>仿真输出配置：</label>
                                <div style="display:flex;flex-wrap:wrap;gap:12px;align-items:center;">
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" id="out-summary" checked>
                                        <span>summary</span>
                                    </label>
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" id="out-tripinfo" checked>
                                        <span>tripinfo</span>
                                    </label>
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" id="out-vehroute">
                                        <span>vehroute</span>
                                    </label>
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" id="out-netstate">
                                        <span>netstate</span>
                                    </label>
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" id="out-fcd">
                                        <span>fcd</span>
                                    </label>
                                    <label style="display:flex;align-items:center;gap:6px;">
                                        <input type="checkbox" id="out-emission">
                                        <span>emission</span>
                                    </label>
                                </div>
                                <div style="font-size:12px;color:#666;margin-top:6px;">建议默认仅开启 summary 与 tripinfo；vehroute/netstate/fcd/emission 按需开启以避免过多I/O。</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="case-description">案例描述:</label>
                            <textarea id="case-description" class="form-control" rows="3" placeholder="可选描述信息"></textarea>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" id="process-od-btn" class="btn btn-primary">处理OD数据</button>
                            <button type="button" id="refresh-templates-btn" class="btn btn-secondary">刷新模板</button>
                        </div>
                    </form>
                </div>
                
                <div id="od-processing-result" class="result-area">
                    <div class="loading">等待处理...</div>
                </div>
            </section>

            <!-- 2. 仿真运行 -->
            <section id="simulation" class="section">
                <h2>仿真运行</h2>
                <div class="simulation-controls">
                    <div class="form-group">
						<label for="simulation-case">选择案例:</label>
						<div class="input-with-btn">
							<select id="simulation-case" class="form-control">
								<option value="">请选择已处理的案例</option>
							</select>
							<button id="refresh-simulation-cases-btn" class="btn btn-secondary btn-inline">刷新案例列表</button>
						</div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="simulation-type">仿真类型:</label>
                            <select id="simulation-type" class="form-control">
                                <option value="microscopic">微观仿真</option>
                                <option value="mesoscopic">中观仿真</option>
                                <option value="macroscopic">宏观仿真</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="gui-mode">运行模式:</label>
                            <select id="gui-mode" class="form-control">
                                <option value="false">后台运行</option>
                                <option value="true">GUI模式</option>
                            </select>
                        </div>
                    </div>
                    
					<div class="form-actions">
						<button id="run-simulation-btn" class="btn btn-primary">启动仿真</button>
					</div>
                </div>
                
                <div class="simulation-status">
                    <div class="status-indicator">
                        <span class="status-dot"></span>
                        <span class="status-text">未开始</span>
                    </div>
                    <div id="simulation-progress" class="progress-bar" style="display: none;">
                        <div class="progress-fill"></div>
                    </div>
                </div>
                
                <div id="simulation-result" class="result-area" style="display:none;"></div>
            </section>

            <!-- 3. 精度分析 -->
            <section id="accuracy-analysis" class="section">
                <h2>结果分析</h2>
                <div class="analysis-controls">
					<div class="form-group">
						<label for="analysis-case">选择案例:</label>
						<div class="input-with-btn">
							<select id="analysis-case" class="form-control">
								<option value="">请选择已完成仿真的案例</option>
							</select>
							<button id="refresh-analysis-cases-btn" class="btn btn-secondary btn-inline">刷新案例列表</button>
						</div>
					</div>
                    
                    <div class="form-group">
                        <label for="analysis-type">分析类型:</label>
                        <select id="analysis-type" class="form-control">
                            <option value="accuracy">精度</option>
                            <option value="mechanism">机理</option>
                            <option value="performance">性能</option>
                        </select>
                    </div>
                    
					<div class="form-actions">
						<button id="run-analysis-btn" class="btn btn-primary">开始分析</button>
						<button id="view-analysis-history-btn" class="btn btn-secondary">查看历史结果</button>
					</div>
                </div>
                
                <div id="analysis-result" class="result-area" style="display:none;"></div>

                <div id="analysis-history" class="result-area" style="margin-top: 12px;"></div>

                <!-- 调试输出（默认隐藏，可在需要时启用） -->
                <div class="debug-panel" style="display:none;">
                    <div class="debug-header">
                        <span>调试输出</span>
                        <div class="debug-actions">
                            <button id="toggle-analysis-debug" class="btn btn-secondary">折叠</button>
                            <button id="clear-analysis-debug" class="btn btn-secondary">清空</button>
                        </div>
                    </div>
                    <pre id="analysis-debug" class="debug-output"></pre>
                </div>
            </section>

            <!-- 4. 案例管理 -->
            <section id="case-management" class="section">
                <h2>案例管理</h2>
                <div class="case-controls">
                    <div class="search-controls">
                        <input type="text" id="case-search" class="form-control" placeholder="搜索案例...">
                        <select id="case-status-filter" class="form-control">
                            <option value="">全部状态</option>
                            <option value="created">已创建</option>
                            <option value="processing">处理中</option>
                            <option value="simulating">仿真中</option>
                            <option value="analyzing">分析中</option>
                            <option value="completed">已完成</option>
                            <option value="failed">失败</option>
                        </select>
                        <button id="refresh-cases-btn" class="btn btn-secondary">刷新</button>
                    </div>
                </div>
                
                <div class="case-list">
                    <div class="loading">加载案例列表...</div>
                </div>
            </section>

            <!-- 5. 模板管理 -->
            <section id="templates" class="section">
                <h2>模板查看</h2>
                <div class="template-tabs">
                    <button class="tab-btn active" data-tab="taz">TAZ模板</button>
                    <button class="tab-btn" data-tab="network">网络模板</button>
                    <button class="tab-btn" data-tab="simulation">仿真模板</button>
                </div>
                <div class="template-content">
                    <div id="taz-templates" class="template-section active">
                        <div class="loading">加载TAZ模板...</div>
                    </div>
                    <div id="network-templates" class="template-section">
                        <div class="loading">加载网络模板...</div>
                    </div>
                    <div id="simulation-templates" class="template-section">
                        <div class="loading">加载仿真模板...</div>
                    </div>
                </div>
            </section>

            
        </main>

        <!-- 模态框 -->
        <div id="modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="modal-body"></div>
            </div>
        </div>
    </div>

    <script src="script.js?v=20250813_1230"></script>
</body>
</html> 
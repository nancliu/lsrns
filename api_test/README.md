# API测试页面使用说明

## 简介

这是一个用于测试OD数据处理API的简单Web界面，可以方便地调用API生成rou.xml文件并运行仿真。

## 使用方法

### 1. 启动API服务器

首先，确保API服务器已经启动：

```bash
# 进入项目根目录
cd 项目根目录

# 启动FastAPI服务器
python sim_scripts/DLLtest2025_6_3.py
```

服务器将在 http://127.0.0.1:7999 启动。

### 2. 启动API测试页面

在Windows系统中，双击运行 `start_api_test.bat` 文件，将自动：
- 启动一个简单的HTTP服务器（端口8080）
- 打开浏览器访问API测试页面

或者，您也可以手动启动：

```bash
# 进入项目根目录
cd 项目根目录

# 启动HTTP服务器
python -m http.server 8080

# 然后在浏览器中访问：http://localhost:8080/api_test/
```

### 3. 使用API测试页面

#### 处理OD数据

1. 填写表单中的参数：
   - 开始时间和结束时间（格式：YYYY/MM/DD HH:MM:SS）
   - 数据库模式和表名
   - TAZ文件和网络文件
   - 时间间隔（分钟）
   - 是否启用中观仿真
   - 选择需要的输出选项

2. 点击"处理数据"按钮
3. 等待处理完成，结果将显示在下方
4. 成功后，第二个表单将自动填充生成的文件路径

#### 运行仿真

1. 确认第二个表单中的文件路径是否正确
2. 选择是否使用GUI模式
3. 点击"运行仿真"按钮
4. 仿真将在SUMO中启动

## 注意事项

1. 确保数据库连接正常
2. 确保SUMO已正确安装并添加到PATH
3. API基础URL默认为 http://127.0.0.1:7999，如有需要可在 script.js 中修改
4. 如果遇到跨域问题，请确保FastAPI服务器已启用CORS

## 故障排除

1. **API连接失败**：确保FastAPI服务器正在运行
2. **数据库连接失败**：检查数据库配置是否正确
3. **仿真启动失败**：检查SUMO安装和文件路径
4. **页面无法加载**：确保HTTP服务器正在运行 